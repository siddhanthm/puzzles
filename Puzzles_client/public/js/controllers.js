var puzzleControllers=angular.module("puzzleControllers",["720kb.datepicker"]),localData={},userData={},baseURL="http://localhost:3000/api/users",passwordURL="http://localhost:3000/api/password",loggedInUser="",editData={};puzzleControllers.controller("homeCtrl",["$scope","$http","$window","$location",function($scope,$http,$window,$location){""==loggedInUser?($scope.msg1="Join",$scope.msg2="Log In"):($scope.msg1="View Profile",$scope.msg2="Logout"),$scope.decidePath1=function(){"Join"==$scope.msg1?$location.path("/signup"):"View Profile"==$scope.msg1&&$location.path("/portfolio/"+loggedInUser)},$scope.decidePath2=function(){"Log In"==$scope.msg2?$location.path("/login"):"Logout"==$scope.msg2&&(loggedInUser="",$scope.msg1="Join",$scope.msg2="Log In")}}]),puzzleControllers.controller("loginCtrl",["$scope","$http","$window","$location",function($scope,$http,$window,$location){$scope.login=function(){var whereQuery="?where={'username':'"+$scope.username+"'}",selectQuery="&&select={_id:1}",urlToGet=baseURL+whereQuery+selectQuery;$http.get(urlToGet).success(function(apiData){if(0==apiData.data.length)$scope.err="Username/Password doesn't exist!";else{var data2send={id:apiData.data[0]._id,password:$scope.password};$http({method:"POST",url:passwordURL,data:$.param(data2send),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(data){1==data.enter?(loggedInUser=$scope.username,$location.path("/portfolio/"+$scope.username)):$scope.err="Username/Password doesn't exist!"}).error(function(){$scope.message="Couldn't post data"})}})}}]),puzzleControllers.controller("signUpCtrl",["$scope","$http","$window","$location",function($scope,$http,$window,$location){var checkUniqueEmail=function(users){for(user in users)if($scope.email==users[user].emailid)return!1;return!0},checkUniqueUsername=function(users){for(user in users)if($scope.username==users[user].username)return!1;return!0};$(".sign-up").click(function(){submitSignUp()});var users,select="?select={emailid:1,username:1}",urlToCall=baseURL+select;$http.get(urlToCall).success(function(apiUsers){users=apiUsers.data});var submitSignUp=function(){checkUniqueEmail(users)&&checkUniqueUsername(users)?(userData.email=$scope.email,userData.username=$scope.username,userData.password=$scope.password,$location.path("/add/basic")):checkUniqueEmail(users)?$scope.msg="Username already exists":$scope.msg="Email already exists",$scope.$apply()}}]),puzzleControllers.controller("portfolioCtrl",["$scope","$http","$window","$location","$anchorScroll","$routeParams",function($scope,$http,$window,$location,$anchorScroll,$routeParams){$scope.logged="",""!=loggedInUser?$scope.logged="Log Out":""==loggedInUser&&($scope.logged="Get Started");var listFormat=function(lists){var data="";for(list in lists)data+=lists[list]+" , ";return data.substring(0,data.length-3)+"."};if("sample"==$routeParams.id)$http.get("./data/data.json").success(function(data){$scope.data=data,$scope.skills=listFormat($scope.data.skills),$scope.education=$scope.data.education[0],$scope.courses=listFormat($scope.data.education[0].courses),$scope.internship=$scope.data.internship,$scope.project=$scope.data.projects,$scope.showOneI=!0,$scope.showTwoI=!0,$scope.showThreeI=!0,$scope.showOneP=!0,$scope.showTwoP=!0,$scope.showThreeP=!0,$scope.ifSample=!0});else{$routeParams.id==loggedInUser&&($scope.myPage=!0,$scope.ifSample=!0);var whereQuery="?where={'username':'"+$routeParams.id+"'}",urlToGet=baseURL+whereQuery;$http.get(urlToGet).success(function(apiData){0==apiData.data.length?($scope.error="User does not exist :(",$location.path("/baduser")):($scope.userID=apiData.data[0]._id,$scope.data=JSON.parse(apiData.data[0].data),$scope.skills=listFormat($scope.data.skills),$scope.education=$scope.data.education,$scope.courses=listFormat($scope.data.education.courses),$scope.internship=$scope.data.internship,$scope.project=$scope.data.projects,void 0==$scope.data.linkedin&&($scope.hideLinkedin=!0),void 0==$scope.data.github&&($scope.hideGithub=!0),0==$scope.internship.length?$scope.hideInternship=!0:1==$scope.internship.length?($scope.showOneI=!0,document.getElementsByClassName("exp-box")[0].style.marginLeft="100%"):2==$scope.internship.length?($scope.showOneI=!0,$scope.showTwoI=!0,document.getElementsByClassName("exp-outerbox")[0].style.marginLeft="22%"):3==$scope.internship.length&&($scope.showOneI=!0,$scope.showTwoI=!0,$scope.showThreeI=!0),0==$scope.project.length?$scope.hideProject=!0:1==$scope.project.length?($scope.showOneP=!0,document.getElementsByClassName("project-box")[0].style.marginLeft="100%"):2==$scope.project.length?($scope.showOneP=!0,$scope.showTwoP=!0,document.getElementsByClassName("project-outerbox")[0].style.marginLeft="22%"):3==$scope.project.length&&($scope.showOneP=!0,$scope.showTwoP=!0,$scope.showThreeP=!0))})}$scope.switchStyle=function(){var path="/portfolio2/"+$routeParams.id;$location.path(path)},$scope.updateInfo=function(){var updateURL="/edit/"+$scope.userID;$location.path(updateURL)},$scope.logout=function(){"Get Started"==$scope.logged?$location.path("/signup"):(loggedInUser="",$location.path("/"))};var number=Math.floor(6*Math.random()+1);1==number?$(".pExp").css({"background-image":"url('./data/images/one.jpg')"}):2==number?$(".pExp").css({"background-image":"url('./data/images/two.jpg')"}):3==number?$(".pExp").css({"background-image":"url('./data/images/three.jpg')"}):4==number?$(".pExp").css({"background-image":"url('./data/images/four.jpg')"}):$(".pExp").css({"background-image":"url('./data/images/five.jpg')"})}]),puzzleControllers.controller("portfolio2Ctrl",["$scope","$http","$window","$location","$anchorScroll","$routeParams",function($scope,$http,$window,$location,$anchorScroll,$routeParams){$scope.logged="",""!=loggedInUser?$scope.logged="Log Out":""==loggedInUser&&($scope.logged="Get Started");var listFormat=function(lists){var data="";for(list in lists)data+=lists[list]+" , ";return data.substring(0,data.length-3)+"."};if("sample"==$routeParams.id)$http.get("./data/data.json").success(function(data){$scope.data=data,$scope.skills=listFormat($scope.data.skills),$scope.education=$scope.data.education[0],$scope.courses=listFormat($scope.data.education[0].courses),$scope.internship=$scope.data.internship,$scope.project=$scope.data.projects,$scope.showOneP=!0,$scope.showTwoP=!0,$scope.showThreeP=!0,$scope.ifSample=!0});else{$routeParams.id==loggedInUser&&($scope.myPage=!0,$scope.ifSample=!0);var whereQuery="?where={'username':'"+$routeParams.id+"'}",urlToGet=baseURL+whereQuery;$http.get(urlToGet).success(function(apiData){0==apiData.data.length?($scope.error="User does not exist :(",$location.path("/baduser")):($scope.userID=apiData.data[0]._id,$scope.data=JSON.parse(apiData.data[0].data),$scope.skills=listFormat($scope.data.skills),$scope.education=$scope.data.education,$scope.courses=listFormat($scope.data.education.courses),$scope.internship=$scope.data.internship,$scope.project=$scope.data.projects,void 0==$scope.data.linkedin&&($scope.hideLinkedin=!0),void 0==$scope.data.github&&($scope.hideGithub=!0),0==$scope.internship.length&&($scope.hideInternship=!0),0==$scope.project.length?$scope.hideProject=!0:1==$scope.project.length?($scope.showOneP=!0,document.getElementsByClassName("project-box")[0].style.marginLeft="100%"):2==$scope.project.length?($scope.showOneP=!0,$scope.showTwoP=!0,document.getElementsByClassName("project-outerbox")[0].style.marginLeft="22%"):3==$scope.project.length&&($scope.showOneP=!0,$scope.showTwoP=!0,$scope.showThreeP=!0))})}$scope.switchStyle=function(){var path="/portfolio/"+$routeParams.id;$location.path(path)},$scope.updateInfo=function(){var updateURL="/edit/"+$scope.userID;$location.path(updateURL)},$scope.logout=function(){"Get Started"==$scope.logged?$location.path("/signup"):(loggedInUser="",$location.path("/"))}}]),puzzleControllers.controller("addUserCtrl",["$scope","$http","$window","$location","$anchorScroll",function($scope,$http,$window,$location,$anchorScroll){var formatCSV=function(courses_data){if(void 0==courses_data)return courses_data;var courses_list=courses_data.split(",");return courses_list},extractInternshipData=function(unprocessed_internship_data){var processed_data=[];for(internship in unprocessed_internship_data){var temp_data={};temp_data.company=unprocessed_internship_data[internship].name,temp_data.description=unprocessed_internship_data[internship].description,temp_data.startDate=unprocessed_internship_data[internship].startDate,temp_data.endDate=unprocessed_internship_data[internship].endDate,processed_data.push(temp_data)}return processed_data},extractProjectData=function(unprocessed_project_data){var processed_data=[];for(project in unprocessed_project_data){var temp_data={};temp_data.name=unprocessed_project_data[project].name,temp_data.description=unprocessed_project_data[project].description,processed_data.push(temp_data)}return processed_data};$scope.internshipChoices=[],$scope.projectChoices=[],$scope.addNewChoice=function(){var newItemNo=$scope.internshipChoices.length+1;$scope.internshipChoices.push({id:"choice"+newItemNo})},$scope.addNewChoiceProject=function(){var newItemNo=$scope.projectChoices.length+1;$scope.projectChoices.push({id:"choice"+newItemNo})},$scope.registerBasic=function(){localData.name=$scope.name,localData.emailid=userData.email,localData.phonenumber=$scope.phonenumber,localData.github=$scope.github,localData.linkedin=$scope.linkedin,localData.skills=formatCSV($scope.skills),void 0!=$scope.name&&void 0!=userData.email&&void 0!=$scope.phonenumber&&void 0!=$scope.skills?$location.path("/add/education"):$scope.message="Please fill in all the required information"},$scope.registerEducation=function(){localData.education={},localData.education.name=$scope.name,localData.education.major=$scope.major,localData.education.startDate=$scope.startDate,localData.education.endDate=$scope.graduationDate,localData.education.CGPA=$scope.cgpa,localData.education.courses=formatCSV($scope.courses),void 0!=$scope.name&&void 0!=$scope.major&&void 0!=$scope.startDate&&void 0!=$scope.graduationDate&&void 0!=$scope.cgpa&&void 0!=$scope.courses?$location.path("/add/internship"):$scope.message="Please fill in all the required information"},$scope.registerInternship=function(){var moveOn=!0;if(localData.internship=extractInternshipData($scope.internshipChoices),localData.internship.length>0)for(var i=0;i<localData.internship.length;i++)""==localData.internship[i].company&&(localData.internship[i].company=void 0),""==localData.internship[i].description&&(localData.internship[i].description=void 0),""==localData.internship[i].startDate&&(localData.internship[i].startDate=void 0),""==localData.internship[i].endDate&&(localData.internship[i].endDate=void 0),(void 0!=localData.internship[i].company||void 0!=localData.internship[i].description||void 0!=localData.internship[i].startDate||void 0!=localData.internship[i].endDate)&&(void 0==localData.internship[i].company||void 0==localData.internship[i].description||void 0==localData.internship[i].startDate||void 0==localData.internship[i].endDate)&&(moveOn=!1);0==moveOn?$scope.message="Please fill in all the required information":$location.path("/add/projects")},$scope.registerProjects=function(){var moveOn=!0;if(localData.projects=extractProjectData($scope.projectChoices),localData.projects.length>0)for(var i=0;i<localData.projects.length;i++)""==localData.projects[i].name&&(localData.projects[i].name=void 0),""==localData.projects[i].description&&(localData.projects[i].description=void 0),(void 0!=localData.projects[i].name||void 0!=localData.projects[i].description)&&(void 0==localData.projects[i].name||void 0==localData.projects[i].description)&&(moveOn=!1);if(0==moveOn)$scope.message="Please fill in all the required information";else{var jsonData=JSON.stringify(localData),data2send={emailid:userData.email,username:userData.username,password:userData.password,data:jsonData};$http({method:"POST",url:baseURL,data:$.param(data2send),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(data){$scope.message="Your profile has been successfully created. Please log in to continue"}).error(function(){$scope.message="Couldn't post data"})}},$scope.discardData=function(){localData={},userData={},$location.path("/")}}]),puzzleControllers.controller("editUserCtrl",["$scope","$http","$window","$location","$anchorScroll","$routeParams",function($scope,$http,$window,$location,$anchorScroll,$routeParams){var listFormat=function(lists){var data="";for(list in lists)data+=lists[list]+",";return data.substring(0,data.length-1)},formatCSV=function(courses_data){if(void 0==courses_data)return courses_data;var courses_list=courses_data.split(",");return courses_list},postData=function(dataToPut){$http({method:"PUT",url:baseURL+"/"+$routeParams.id,data:$.param(dataToPut),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(putdata){}).error(function(err){$scope.message=err.message})},userURL=baseURL+"/"+$routeParams.id+"/";$http.get(userURL).success(function(userData){$scope.editUser=userData.data,$scope.username=userData.data.username,editData=JSON.parse(userData.data.data),$scope.name=editData.name,$scope.phonenumber=editData.phonenumber,$scope.linkedin=editData.linkedin,$scope.github=editData.github,$scope.skills=listFormat(editData.skills),$scope.education=editData.education,$scope.uniname=editData.education.name,$scope.major=editData.education.major,$scope.cgpa=editData.education.CGPA,$scope.startDate=editData.education.startDate,$scope.graduationDate=editData.education.endDate,$scope.courses=listFormat(editData.education.courses)}),$scope.registerBasic=function(){editData.name=$scope.name,editData.phonenumber=$scope.phonenumber,editData.linkedin=$scope.linkedin,editData.github=$scope.github,editData.skills=formatCSV($scope.skills),$scope.editUser.data=JSON.stringify(editData),void 0!=$scope.name&&void 0!=$scope.phonenumber&&void 0!=$scope.skills?(postData($scope.editUser),$location.path("/edit/"+$routeParams.id)):$scope.message="Please fill in all the required information"},$scope.registerEducation=function(){editData.education.name=$scope.uniname,editData.education.major=$scope.major,editData.education.CGPA=$scope.cgpa,editData.education.startDate=$scope.startDate,editData.education.endDate=$scope.graduationDate,editData.education.courses=formatCSV($scope.courses),$scope.editUser.data=JSON.stringify(editData),void 0!=$scope.uniname&&void 0!=$scope.major&&void 0!=$scope.startDate&&void 0!=$scope.graduationDate&&void 0!=$scope.cgpa&&void 0!=$scope.courses?(postData($scope.editUser),$location.path("/edit/"+$routeParams.id)):$scope.message="Please fill in all the required information"},$scope.deleteUser=function(){localData={},userData={},editData={},loggedInUser="",$http["delete"](userURL).success(function(data){$location.path("/")})};var extractInternshipData=function(unprocessed_internship_data){var processed_data=[];for(internship in unprocessed_internship_data){var temp_data={};temp_data.company=unprocessed_internship_data[internship].name,temp_data.description=unprocessed_internship_data[internship].description,temp_data.startDate=unprocessed_internship_data[internship].startDate,temp_data.endDate=unprocessed_internship_data[internship].endDate,processed_data.push(temp_data)}return processed_data},extractProjectData=function(unprocessed_project_data){var processed_data=[];for(project in unprocessed_project_data){var temp_data={};temp_data.name=unprocessed_project_data[project].name,temp_data.description=unprocessed_project_data[project].description,processed_data.push(temp_data)}return processed_data};$scope.internshipChoices=[],$scope.projectChoices=[],$scope.addNewChoice=function(){var newItemNo=$scope.internshipChoices.length+1;$scope.internshipChoices.push({id:"choice"+newItemNo})},$scope.addNewChoiceProject=function(){var newItemNo=$scope.projectChoices.length+1;$scope.projectChoices.push({id:"choice"+newItemNo})},$scope.registerInternship=function(){var moveOn=!0;if(editData.internship=extractInternshipData($scope.internshipChoices),editData.internship.length>0)for(var i=0;i<editData.internship.length;i++)""==editData.internship[i].company&&(editData.internship[i].company=void 0),""==editData.internship[i].description&&(editData.internship[i].description=void 0),""==editData.internship[i].startDate&&(editData.internship[i].startDate=void 0),""==editData.internship[i].endDate&&(editData.internship[i].endDate=void 0),(void 0!=editData.internship[i].company||void 0!=editData.internship[i].description||void 0!=editData.internship[i].startDate||void 0!=editData.internship[i].endDate)&&(void 0==editData.internship[i].company||void 0==editData.internship[i].description||void 0==editData.internship[i].startDate||void 0==editData.internship[i].endDate)&&(moveOn=!1);0==moveOn?$scope.message="Please fill in all the required information":($scope.editUser.data=JSON.stringify(editData),postData($scope.editUser),$location.path("/edit/"+$routeParams.id))},$scope.registerProjects=function(){var moveOn=!0;if(editData.projects=extractProjectData($scope.projectChoices),editData.projects.length>0)for(var i=0;i<editData.projects.length;i++)""==editData.projects[i].name&&(editData.projects[i].name=void 0),""==editData.projects[i].description&&(editData.projects[i].description=void 0),(void 0!=editData.projects[i].name||void 0!=editData.projects[i].description)&&(void 0==editData.projects[i].name||void 0==editData.projects[i].description)&&(moveOn=!1);0==moveOn?$scope.message="Please fill in all the required information":($scope.editUser.data=JSON.stringify(editData),postData($scope.editUser),$location.path("/edit/"+$routeParams.id))},$scope.editInternship=function(){$location.path("/edit/"+$routeParams.id+"/internship")},$scope.discardData=function(){$location.path("/edit/"+$routeParams.id)},$scope.editBasic=function(){$location.path("/edit/"+$routeParams.id+"/basic")},$scope.editEducation=function(){$location.path("/edit/"+$routeParams.id+"/education")},$scope.editProjects=function(){$location.path("/edit/"+$routeParams.id+"/projects")},$scope.doneEditing=function(){$location.path("/portfolio/"+$scope.username)}}]);